# Checkov configuration for Terraform Azure Modules

# Directories to scan
directory:
  - modules

# Skip paths (exclude examples directories)
skip-path:
  - modules/app-service-web/examples/
  - modules/monitoring/examples/

# File types to scan
framework:
  - terraform

# Skip specific checks (add check IDs to skip)
skip-check:
  - CKV_AZURE_1 # Ensure that 'Secure transfer required' is set to 'Enabled'
  - CKV2_AZURE_1 # Ensure storage for critical data are encrypted with Customer Managed Key
  - CKV2_AZURE_8 # Ensure the storage account containing the container with activity logs is encrypted with BYOK (Use Your Own Key)
  - CKV_AZURE_225 # Ensure the App Service Plan is zone redundant
  - CKV_AZURE_212 # Ensure App Service has a minimum number of instances for failover
  - CKV_AZURE_211 # Ensure App Service plan suitable for production use
  - CKV_AZURE_244 # Avoid the use of local users for Azure Storage unless necessary
  - CKV_AZURE_213 # Ensure that App Service configures health check
  - CKV_AZURE_16 # Ensure that Register with Azure Active Directory is enabled on App Service
  - CKV_AZURE_13 # Ensure App Service Authentication is set on Azure App Service
  - CKV_AZURE_88 # Ensure that app services use Azure Files
  - CKV_AZURE_65 # Ensure that App service enables detailed error messages
  - CKV_AZURE_71 # Ensure that Managed identity provider is enabled for app services
  - CKV_AZURE_17 # Ensure the web app has 'Client Certificates (Incoming client certificates)' set
  - CKV_AZURE_66 # Ensure that App service enables failed request tracing
  - CKV_AZURE_222 # Ensure that Azure Web App public network access is disabled
  - CKV_AZURE_63 # Ensure that App service enables HTTP logging
  - CKV2_AZURE_31 # Ensure VNET subnet is configured with a Network Security Group (NSG)
  - CKV2_AZURE_38 # Ensure soft-delete is enabled on Azure storage account
  - CKV2_AZURE_33 # Ensure storage account is configured with private endpoint

# Output format
output: cli

# Quiet mode (reduce verbosity)
quiet: false

# Compact output
compact: true

# Download external modules
download-external-modules: false

# External checks directory
external-checks-dir: []

# Baseline file for suppressing known issues
# baseline: .checkov.baseline

# Soft fail mode (don't exit with error code)
soft-fail: false

# Skip downloading of external modules
skip-download: true
